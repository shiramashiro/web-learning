<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>03.树形控件</title>
  <link rel="stylesheet" href="./index.css">
  <script src="https://cdn.bootcdn.net/ajax/libs/jquery/3.6.0/jquery.js"></script>
</head>
<body>
<div id="app">
</div>
<script type="text/javascript">
  function strToBool(str) {
    return str !== "false";
  }

  function boolToStr(bool) {
    return bool === false ? "false" : "true";
  }

  let treeOcxData = [
    {
      tip: "分类",
      child: [
        {
          tip: "设计作品",
          child: [
            {
              tip: "作品1"
            },
            {
              tip: "作品2"
            }
          ]
        },
        {
          tip: "技巧杂烩",
          child: [
            {
              tip: "Web 前端",
              child: [ { tip: "Vue.js" }, { tip: "JavaScript" },
                {
                  tip: "HTML",
                  child: [
                    {
                      tip: "Canvas",
                      child: [ { tip: "beginPath()" }, { tip: "closePath()" } ]
                    },
                    { tip: "Audio" }
                  ]
                }
              ]
            },
            {
              tip: "Python"
            },
            {
              tip: "Java"
            }
          ]
        },
        {
          tip: "生活随笔"
        },
        {
          tip: "兴趣爱好"
        }
      ]
    },
    {
      tip: "导航",
      child: [ { tip: "固钉" }, { tip: "回到顶部" }, { tip: "面包屑" } ]
    },
    {
      tip: "数据展示"
    }
  ];

  function rendChild(data, enableCursor) {
    let template = ``;
    if ( enableCursor ) {
      template = `<ul class="tree-ocx-ul enable-display">`;
    } else {
      template = `<ul class="tree-ocx-ul">`;
    }
    for ( let i = 0; i < data.length; i++ ) {
      template += `<li class="enable-cursor" data-displayed="false" onclick="display(this)"><div class="tree-ocx-tip">${ data[i].tip }</div>`;
      if ( data[i].child ) {
        template += `${ rendChild(data[i].child, true) }`;
      } else {
        template += `${ rendChild("", false) }`;
      }
      template += `</li>`;
    }
    template += `</ul>`;
    return template;
  }

  $("#app").append(rendChild(treeOcxData));

  function display(e) {
    let displayed = strToBool($(e)[0].dataset.displayed);
    if ( displayed === false ) {
      $(e).css({
        "--tip-height": `${ $(e).children(".tree-ocx-tip").height() }px`,
        "--li-height": `${ $(e).children(".enable-display").height() }px`
      });
      $(e).addClass("enable-cursor-active");
      $(e).children(".enable-display").addClass("enable-display-active");
    } else {
      $(e).removeClass("enable-cursor-active");
      $(e).children(".enable-display").removeClass("enable-display-active");
    }
    // $(e)[0].dataset.displayed = boolToStr(!displayed);
  }

</script>
</body>
</html>