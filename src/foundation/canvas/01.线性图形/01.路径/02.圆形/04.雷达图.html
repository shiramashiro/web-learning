<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>04.雷达图</title>
    <style>
        #canvas {
            border: 1px solid rgba(110, 110, 110, 0.8);
            border-radius: 10px;
        }

        #canvas-container {
            display: flex;
            justify-content: center;
        }
    </style>
</head>
<body>
<div id="canvas-container">
    <canvas id="canvas" width="400" height="400">Your browser version is too late.</canvas>
</div>
<script src="../../../utils.js"></script>
<script type="text/javascript">
    let canvas = document.getElementById('canvas');
    let ctx = canvas.getContext('2d');
    drawGrid(400, 400, 20);

    let data = [
        {
            title: 'js',
            star: 4,
        },
        {
            title: 'ts',
            star: 2
        },
        {
            title: 'html',
            star: 4
        },
        {
            title: 'css',
            star: 4
        },
        {
            title: 'vue',
            star: 3
        },
        {
            title: 'uniapp',
            star: 3,
        },
        {
            title: 'java',
            star: 2
        },
        {
            title: 'flutter',
            star: 2
        },
        {
            title: 'dart',
            star: 3
        },
        {
            title: 'python',
            star: 1
        },
    ];

    let options = {
        radar: {
            lineWidth: 1,
            lineColor: 'black',
            textColor: 'black',
            textSize: 16,
        },
        dataArea: {
            lineWidth: 2,
            lineColor: 'blue',
            fillColor: 'rgba(100,149,237, 0.6)',
        }
    };

    ctx.strokeStyle = 'black';
    drawPolygonPath(5, 20, 10, 200, 200, data, options, ctx);

    function drawPolygonPath(layer, step, sides, x, y, data, options, ctx) {
        let coordinates = [];
        let radius = step;
        ctx.strokeStyle = options.radar.lineColor;
        ctx.lineWidth = options.radar.lineWidth;
        for (let j = 0; j < layer; j++) {
            ctx.beginPath();
            let averageAngle = Math.PI * 2 / sides;
            let increaseAngle = 0;
            let lengthX, lengthY, targetX, targetY;
            coordinates.push({layer: j, coords: []});
            for (let i = 0; i < sides; i++) {
                lengthX = radius * Math.cos(increaseAngle);
                targetX = x + lengthX;
                lengthY = radius * Math.sin(increaseAngle);
                targetY = y - lengthY;
                ctx.lineTo(targetX, targetY);
                increaseAngle += averageAngle;
                coordinates[j].coords.push({x: targetX, y: targetY});
            }
            ctx.closePath();
            ctx.stroke();
            radius = radius + step;
        }
        drawStria(sides, coordinates, x, y, options, ctx);
        drawData(sides, coordinates, data, options, ctx);
    }

    function drawStria(surface, coordinates, originX, originY, options, ctx) {
        let length = coordinates.length;
        let coords = coordinates[length - 1].coords;
        for (let i = 0; i < surface; i++) {
            ctx.beginPath();
            ctx.moveTo(originX, originY);
            ctx.lineTo(coords[i].x, coords[i].y);
            ctx.closePath();
            ctx.stroke();
        }
    }

    function drawData(surface, coordinates, data, options, ctx) {
        let length = coordinates.length;
        let lastLayer = coordinates[length - 1].coords;
        ctx.beginPath();
        ctx.moveTo(0, 0);
        ctx.font = `${options.radar.textSize}px Georgia`;
        ctx.strokeStyle = options.dataArea.lineColor;
        ctx.lineWidth = options.dataArea.lineWidth;
        for (let i = 0; i < surface; i++) {
            ctx.fillText(data[i].title, lastLayer[i].x, lastLayer[i].y);
            let layer = data[i].star - 1;
            if (i === 0) {
                ctx.moveTo(coordinates[layer].coords[i].x, coordinates[layer].coords[i].y);
            } else {
                ctx.lineTo(coordinates[layer].coords[i].x, coordinates[layer].coords[i].y);
            }
        }
        ctx.closePath();
        ctx.stroke();
        ctx.fillStyle = options.dataArea.fillColor;
        ctx.fill();
    }
</script>
</body>
</html>